<!DOCTYPE html>
<html>
  <head>
    <base target="_top" />
    <!-- Add any external scripts and stylesheets here -->
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <section id="index">
      <!-- bundled js and css will get inlined here during build-->
    </section>
  <script type="text/javascript" src="https://unpkg.com/react@17.0.2/umd/react.production.min.js"></script><script type="text/javascript" src="https://unpkg.com/react-dom@17.0.2/umd/react-dom.production.min.js"></script><script type="text/javascript" src="https://unpkg.com/react-bootstrap@1.3.0/dist/react-bootstrap.min.js"></script><script type="text/javascript" src="https://unpkg.com/react-transition-group@4.4.1/dist/react-transition-group.min.js"></script><script type="text/javascript">!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t){e.exports=React},function(e,t){e.exports=ReactBootstrap},function(e,t,n){"use strict";t.__esModule=!0,t.serverFunctions=void 0;var r=new(n(10).GASClient)({allowedDevelopmentDomains:function(e){return/https:\/\/.*\.googleusercontent\.com$/.test(e)}}).serverFunctions;t.serverFunctions=r},function(e,t){e.exports=ReactTransitionGroup},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t};t.__esModule=!0;var i=a(n(0)),s=n(1);t.default=function(e){var t=e.submitNewSheet,n=i.useState(""),r=n[0],o=n[1];return i.default.createElement(s.Form,{onSubmit:function(e){e.preventDefault(),0!==r.length&&(t(r),o(""))}},i.default.createElement(s.Form.Group,{controlId:"formNewSheet"},i.default.createElement(s.Form.Label,null,"Add a new sheet"),i.default.createElement(s.Row,null,i.default.createElement(s.Col,{xs:10},i.default.createElement(s.Form.Control,{type:"text",placeholder:"Sheet name",value:r,onChange:function(e){return o(e.target.value)}})),i.default.createElement(s.Col,{xs:2},i.default.createElement(s.Button,{variant:"primary",type:"submit"},"Submit"))),i.default.createElement(s.Form.Text,{className:"text-muted"},"Enter the name for your new sheet."),i.default.createElement(s.Form.Text,{className:"text-muted"},i.default.createElement("i",null,"This component is written in typescript!"))))}},function(e,t,n){var r=n(7),o=n(8);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var a={insert:"head",singleton:!1};r(o,a);e.exports=o.locals||{}},function(e,t,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function s(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],o=0;o<e.length;o++){var a=e[o],c=t.base?a[0]+t.base:a[0],u=n[c]||0,l="".concat(c," ").concat(u);n[c]=u+1;var f=s(l),p={css:a[1],media:a[2],sourceMap:a[3]};-1!==f?(i[f].references++,i[f].updater(p)):i.push({identifier:l,updater:h(p,t),references:1}),r.push(l)}return r}function u(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var l,f=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function p(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,o);else{var a=document.createTextNode(o),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function d(e,t,n){var r=n.css,o=n.media,a=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),a&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var m=null,v=0;function h(e,t){var n,r,o;if(t.singleton){var a=v++;n=m||(m=u(t)),r=p.bind(null,n,a,!1),o=p.bind(null,n,a,!0)}else n=u(t),r=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=s(n[r]);i[o].references--}for(var a=c(e,t),u=0;u<n.length;u++){var l=s(n[u]);0===i[l].references&&(i[l].updater(),i.splice(l,1))}n=a}}}},function(e,t,n){(t=n(9)(!1)).push([e.i,"/* needed to make consistent test snapshots across OSs */\nbody {\n  font-family: Arial, Helvetica, sans-serif !important;\n}\n\n/*\nCSSTransitionGroup styling\n */\n.sheetNames-enter {\n  opacity: 0;\n}\n\n.sheetNames-enter.sheetNames-enter-active {\n  opacity: 1;\n  transition: opacity 300ms ease-in;\n}\n\n.sheetNames-exit {\n  opacity: 1;\n}\n\n.sheetNames-exit.sheetNames-exit-active {\n  opacity: 0;\n  transition: opacity 300ms ease-in;\n}\n\n.sheetNames-appear {\n  opacity: 0;\n}\n\n.sheetNames-appear.sheetNames-appear-active {\n  opacity: 1;\n  transition: opacity 0.5ms ease-in;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(i=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),a=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([o]).join("\n")}var i,s,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(o[i]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"GASClient",(function(){return _}));var r,o,a=["withFailureHandler","withLogger","withSuccessHandler","withUserObject"],i=function(){function e(){this._serverFunctions={}}return Object.defineProperty(e.prototype,"serverFunctions",{get:function(){return this._serverFunctions},enumerable:!1,configurable:!0}),e}(),s=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),c=function(){return(c=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},u=function(e){function t(){var t=e.call(this)||this;return t.promisifyGASFunctions(),t}return s(t,e),t.prototype.promisifyGASFunctions=function(){this._serverFunctions=Object.keys(google.script.run).reduce((function(e,t){var n;return a.includes(t)?e:c(c({},e),((n={})[t]=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new Promise((function(n,r){var o;(o=google.script.run.withSuccessHandler(n).withFailureHandler(r))[e].apply(o,t)}))}}(t),n))}),{})},t}(i),l=new Uint8Array(16);function f(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(l)}var p=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var d=function(e){return"string"==typeof e&&p.test(e)},m=[],v=0;v<256;++v)m.push((v+256).toString(16).substr(1));var h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(m[e[t+0]]+m[e[t+1]]+m[e[t+2]]+m[e[t+3]]+"-"+m[e[t+4]]+m[e[t+5]]+"-"+m[e[t+6]]+m[e[t+7]]+"-"+m[e[t+8]]+m[e[t+9]]+"-"+m[e[t+10]]+m[e[t+11]]+m[e[t+12]]+m[e[t+13]]+m[e[t+14]]+m[e[t+15]]).toLowerCase();if(!d(n))throw TypeError("Stringified UUID is invalid");return n};var y=function(e,t,n){var r=(e=e||{}).random||(e.rng||f)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return h(r)},g=function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},b=function(e,t){var n=y(),r=new Promise((function(e,t){window.gasStore[n]={resolve:e,reject:t}}));return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return window.parent.postMessage({type:"REQUEST",id:n,functionName:t,args:g([],e)},"*"),r}},w=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),S=function(e){function t(t){var n=e.call(this)||this;return n._config=t,window.gasStore={},window.addEventListener("message",n.buildMessageListener(),!1),n._serverFunctions=new Proxy({},{get:b}),n}return w(t,e),t.prototype.buildMessageListener=function(){var e=this;return function(t){var n,r,o;if((r=t.origin,"string"==typeof(o=null===(n=e._config)||void 0===n?void 0:n.allowedDevelopmentDomains)?o.split(" ").some((function(e){return e===r})):"function"==typeof o&&!0===o(r))&&"RESPONSE"===t.data.type){var a=t.data,i=a.response,s=a.status,c=a.id,u=window.gasStore[c],l=u.resolve,f=u.reject;"ERROR"===s&&f(i),l(i)}}},t}(i),_=function(){function e(e){var t;this._config=e,"undefined"!=typeof google&&Boolean(null===(t=null===google||void 0===google?void 0:google.script)||void 0===t?void 0:t.run)?this._functionHost=new u:this._functionHost=new S(this._config)}return Object.defineProperty(e.prototype,"serverFunctions",{get:function(){return this._functionHost.serverFunctions},enumerable:!1,configurable:!0}),e}()},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),a=n(4),i=n.n(a),s=n(3),c=n(1),u=n(5),l=n.n(u),f=n(2);var p=()=>{const[e,t]=Object(r.useState)([]);Object(r.useEffect)(()=>{f.serverFunctions.getSheetsData().then(t).catch(alert)},[]);return o.a.createElement("div",{style:{padding:"3px",overflowX:"hidden"}},o.a.createElement("p",null,o.a.createElement("b",null,"☀️ Bootstrap demo! ☀️")),o.a.createElement("p",null,"This is a sample app that uses the ",o.a.createElement("code",null,"react-bootstrap")," library to help us build a simple React app. Enter a name for a new sheet, hit enter and the new sheet will be created. Click the red"," ",o.a.createElement("span",{className:"text-danger"},"×")," next to the sheet name to delete it."),o.a.createElement(l.a,{submitNewSheet:async e=>{try{const n=await f.serverFunctions.addSheet(e);t(n)}catch(e){alert(e)}}}),o.a.createElement(c.ListGroup,null,o.a.createElement(s.TransitionGroup,{className:"sheet-list"},e.length>0&&e.map(e=>o.a.createElement(s.CSSTransition,{classNames:"sheetNames",timeout:500,key:e.name},o.a.createElement(c.ListGroup.Item,{className:"d-flex",key:`${e.index}-${e.name}`},o.a.createElement(c.Button,{className:"border-0",variant:"outline-danger",size:"sm",onClick:()=>{return n=e.index,void f.serverFunctions.deleteSheet(n).then(t).catch(alert);var n}},"×"),o.a.createElement(c.Button,{className:"border-0 mx-2",variant:e.isActive?"success":"outline-success",onClick:()=>{return n=e.name,void f.serverFunctions.setActiveSheet(n).then(t).catch(alert);var n}},e.name)))))))};n(6);i.a.render(o.a.createElement(p,null),document.getElementById("index"))}]);</script></body>
</html>
